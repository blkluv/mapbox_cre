<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ATLWarehouse Grid</title>

<script src="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.js"></script>
<link href="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.css" rel="stylesheet">

<style>
body { margin:0; padding:0; background:#0a0a0a; font-family:Arial; }
#map { position:absolute; top:60px; bottom:0; width:100%; }

#header {
position:fixed;
top:0;
width:100%;
height:60px;
background:linear-gradient(90deg,#00ffea,#ff00ff);
display:flex;
align-items:center;
justify-content:center;
gap:30px;
z-index:1000;
font-weight:bold;
}

#header a {
color:#000;
text-decoration:none;
background:#fff;
padding:6px 12px;
border-radius:6px;
font-size:14px;
}

#counter {
color: black;
background: white;
padding: 6px 12px;
border-radius: 6px;
font-size: 14px;
font-weight: bold;
}

/* Filter bar */
#filter-bar {
position: fixed;
top: 70px;
left: 10px;
right: 10px;
display: flex;
gap: 10px;
overflow-x: auto;
padding: 10px;
z-index: 999;
}

.filter-btn {
background: rgba(0,0,0,0.8);
border: 1px solid #ff00ff;
border-radius: 25px;
padding: 8px 20px;
font-size: 13px;
color: #ff00ff;
cursor: pointer;
white-space: nowrap;
}

.filter-btn.active {
background: #ff00ff;
color: black;
}

/* Bottom sheet */
#sheet {
position: fixed;
left: 10px;
right: 10px;
bottom: 10px;
background: rgba(10,10,10,0.95);
border-radius: 25px;
border: 1px solid #00ffea;
transform: translateY(120%);
transition: transform 0.4s;
z-index: 2000;
padding: 25px;
}

#sheet.open { transform: translateY(0); }

#close-btn {
position: absolute;
top: 15px;
right: 15px;
background: none;
border: none;
color: white;
font-size: 24px;
cursor: pointer;
}

.stat-box {
background: rgba(255,255,255,0.05);
padding: 15px;
border-radius: 12px;
}

.mapboxgl-popup-content {
background:#111 !important;
color:#fff;
border-radius:12px;
}

.mapboxgl-popup-content h3 {
color:#00ffea;
margin-bottom:8px;
}

#telegram-widget {
position: fixed;
bottom: 20px;
left: 20px;
background: #0088cc;
color: white;
padding: 12px 25px;
border-radius: 40px;
display: flex;
align-items: center;
gap: 12px;
cursor: pointer;
z-index: 2000;
font-weight: bold;
}
</style>
</head>
<body>

<div id="header">
<a href="https://ops.ATLwarehouse.com">‚öôÔ∏è OPS</a>
<a href="https://ATLwarehouse.com">üè† HOME</a>
<a href="https://tiktok.com/@atlwarehouse">üéµ TIKTOK</a>
<a href="#" onclick="openTelegram()">üì± TELEGRAM</a>
<span id="counter">SCANNING...</span>
</div>

<div id="filter-bar">
<div class="filter-btn active" onclick="filterFacilities('all')">ALL FACILITIES</div>
<div class="filter-btn" onclick="filterFacilities('vacant')">VACANT NOW</div>
<div class="filter-btn" onclick="filterFacilities('ugc')">HAS UGC</div>
</div>

<div id="map"></div>

<div id="telegram-widget" onclick="openTelegram()">
<img src="https://telegram.org/img/website_icon.svg" width="24" height="24" style="filter: invert(1);">
<span>@atlwarehouse ‚Ä¢ LIVE</span>
</div>

<div id="sheet">
<button id="close-btn" onclick="closeSheet()">√ó</button>
<div style="display:flex; justify-content:space-between; align-items:center;">
<div>
<h2 id="s-name" style="margin:0; color:#00ffea;">WAREHOUSE</h2>
<p id="s-loc" style="margin:5px 0; color:#888;">Atlanta Industrial District</p>
</div>
<div style="font-size:40px; font-weight:900; color:#00ffea;" id="s-grade">A</div>
</div>

<div style="display:grid; grid-template-columns: 1fr 1fr; gap:15px; margin-top:20px;">
<div class="stat-box">
<div style="font-size:10px; color:#00ffea;">POWER CAPACITY</div>
<div style="font-size:20px; font-weight:900;" id="s-power">4.5 MW</div>
</div>
<div class="stat-box">
<div style="font-size:10px; color:#ff00ff;">DRAYAGE ZONE</div>
<div style="font-size:20px; font-weight:900;" id="s-zone">INNER RING</div>
</div>
</div>

<div style="display:grid; grid-template-columns: 1fr 1fr; gap:10px; margin-top:20px;">
<button onclick="pinToTikTok()" style="padding:15px; border-radius:12px; border:none; background:#ff00ff; color:white; font-weight:900; cursor:pointer;">
üìπ PIN YOUR TIKTOK
</button>
<button onclick="joinTelegram()" style="padding:15px; border-radius:12px; border:1px solid #0088cc; background:transparent; color:#0088cc; font-weight:900; cursor:pointer;">
üí¨ DISCUSS
</button>
</div>
</div>

<script>

// REPLACE WITH YOUR ACTUAL MAPBOX TOKEN
mapboxgl.accessToken = "YOUR_MAPBOX_TOKEN";

const map = new mapboxgl.Map({
container:"map",
style:"mapbox://styles/mapbox/dark-v11",
center:[-84.39,33.77],
zoom:10
});

map.addControl(new mapboxgl.NavigationControl());

// Store markers for filtering
let allMarkers = [];
let currentFacility = null;

// Load warehouses
async function loadWarehouses(){

const query = `
[out:json][timeout:25];
(
  node["building"="warehouse"](33.45,-84.70,34.05,-84.10);
  way["building"="warehouse"](33.45,-84.70,34.05,-84.10);
);
out center;
`;

const response = await fetch("https://overpass-api.de/api/interpreter",{
method:"POST",
body:query
});

const data = await response.json();
document.getElementById('counter').innerText = `NETWORK: ${data.elements.length} UNITS`;

data.elements.forEach((el, index) => {

let coords;

if(el.type === "node"){
coords = [el.lon, el.lat];
}
else if(el.type === "way" && el.center){
coords = [el.center.lon, el.center.lat];
}
else return;

const name = el.tags?.name || "Warehouse Facility";

// Generate random data for demo
const power = (Math.random() * 5 + 1).toFixed(1);
const grade = ['A', 'B+', 'A-'][Math.floor(Math.random() * 3)];
const utilization = Math.floor(Math.random() * 100);
const hasUGC = Math.random() > 0.6;

// Create marker
const marker = new mapboxgl.Marker({color: hasUGC ? "#ff00ff" : "#00ffea"})
.setLngLat(coords)
.setPopup(new mapboxgl.Popup({maxWidth:"300px"}).setHTML(`
<div style="max-width:280px;">
<h3>${name} ${hasUGC ? 'üì±' : ''}</h3>
<p>üì¶ Utilization: ${utilization}%</p>
<p>‚ö° Power: ${power} MW</p>
<p>üèÜ Grade: ${grade}</p>
<hr style="border-color:#333;">
<button onclick="window.pinFromPopup('${name}')" style="
width:100%;
padding:8px;
background:#ff00ff;
color:white;
border:none;
font-weight:bold;
cursor:pointer;
border-radius:6px;">
üìπ Pin Your TikTok
</button>
</div>
`))
.addTo(map);

// Store data for filtering
marker._data = {
name: name,
power: power,
grade: grade,
utilization: utilization,
hasUGC: hasUGC
};

// Click handler for sheet
marker.getElement().addEventListener('click', () => {
currentFacility = marker._data;
openSheet(marker._data);
});

allMarkers.push(marker);
});

}

// Filter functions
function filterFacilities(filter) {
document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
event.target.classList.add('active');

allMarkers.forEach(marker => {
if(filter === 'all') {
marker.getElement().style.display = 'block';
} else if(filter === 'vacant') {
marker.getElement().style.display = marker._data.utilization < 30 ? 'block' : 'none';
} else if(filter === 'ugc') {
marker.getElement().style.display = marker._data.hasUGC ? 'block' : 'none';
}
});
}

// Sheet functions
function openSheet(data) {
document.getElementById('s-name').innerText = data.name;
document.getElementById('s-grade').innerText = data.grade;
document.getElementById('s-power').innerText = data.power + " MW";
document.getElementById('s-zone').innerText = data.utilization > 70 ? "HIGH TRAFFIC" : "NORMAL";
document.getElementById('sheet').classList.add('open');
}

function closeSheet() {
document.getElementById('sheet').classList.remove('open');
}

// TikTok functions
function pinToTikTok() {
if(!currentFacility) {
alert('Please click a warehouse first');
return;
}
window.open('https://tiktok.com/@atlwarehouse', '_blank');
alert('üì± After posting, DM @atlwarehouse on TikTok to get pinned!');
}

window.pinFromPopup = function(name) {
currentFacility = { name: name };
pinToTikTok();
}

// Telegram functions
function openTelegram() {
window.open('https://t.me/atlwarehouse', '_blank');
}

function joinTelegram() {
if(!currentFacility) {
openTelegram();
return;
}
window.open('https://t.me/atlwarehouse', '_blank');
}

// Load warehouses when map loads
map.on('load', loadWarehouses);

</script>

</body>
</html>
